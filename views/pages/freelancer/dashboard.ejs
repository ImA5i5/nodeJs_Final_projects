<!-- views/pages/freelancer/dashboard.ejs -->
<div class="max-w-7xl mx-auto mt-10">

  <!-- âœ… TOP STATS -->
  <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
    
    <div class="bg-purple-600 text-white rounded-xl p-6 shadow-lg">
      <h3 class="text-lg font-semibold">ğŸ’¼ Total Bids</h3>
      <p class="text-4xl font-bold mt-2"><%= bids.length %></p>
    </div>

    <div class="bg-green-600 text-white rounded-xl p-6 shadow-lg">
      <h3 class="text-lg font-semibold">ğŸ’° Total Earnings</h3>
      <p class="text-4xl font-bold mt-2">â‚¹<%= earnings %></p>
    </div>

    <div class="bg-blue-600 text-white rounded-xl p-6 shadow-lg">
      <h3 class="text-lg font-semibold">ğŸš€ Active Projects</h3>
      <p class="text-4xl font-bold mt-2"><%= activeProjects %></p>
    </div>

    <div class="bg-purple-600 text-white rounded-xl p-6 shadow-lg">
      <h3 class="text-lg font-semibold">âœ… Completed Projects</h3>
      <p class="text-4xl font-bold mt-2"><%= completedProjects %></p>
    </div>

  </div>

  <!-- âœ… RATING -->
  <div class="bg-white shadow rounded-xl p-6 mb-10">
    <h3 class="text-xl font-bold mb-3">â­ Your Rating</h3>
    
    <div class="w-full bg-gray-200 rounded-full h-3 overflow-hidden">
      <div class="bg-yellow-400 h-3 rounded-full" style="width: <%= rating * 20 %>%"></div>
    </div>

    <p class="mt-2 text-gray-700 font-semibold text-lg"><%= rating %> / 5</p>
  </div>

  <!-- âœ… Monthly Earnings Graph -->
  <div class="bg-white shadow rounded-xl p-6 mb-10">
    <h3 class="text-xl font-bold mb-4">ğŸ“Š Monthly Earnings</h3>
    <canvas id="earningsChart" height="120"></canvas>
  </div>

  <!-- âœ… Recent Payments -->
  <div class="bg-white shadow rounded-xl p-6 mb-10">
    <h3 class="text-xl font-bold mb-4">ğŸ’¸ Recent Payments</h3>

    <% if (recentPayments.length === 0) { %>
      <p class="text-gray-500">No payments yet.</p>
    <% } else { %>
    <table class="w-full border">
      <thead class="bg-gray-100">
        <tr>
          <th class="px-4 py-2 border">Project</th>
          <th class="px-4 py-2 border">Amount</th>
          <th class="px-4 py-2 border">Date</th>
        </tr>
      </thead>
      <tbody>
        <% recentPayments.forEach(p => { %>
          <tr class="border-b">
            <td class="px-4 py-2"><%= p.project?.title || "N/A" %></td>
            <td class="px-4 py-2">â‚¹<%= p.amount %></td>
            <td class="px-4 py-2"><%= new Date(p.createdAt).toLocaleDateString() %></td>
          </tr>
        <% }) %>
      </tbody>
    </table>
    <% } %>
  </div>

</div>

<!-- âœ… Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
  const ctx = document.getElementById("earningsChart");

  new Chart(ctx, {
    type: "line",
    data: {
      labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
      datasets: [{
        label: "Earnings (â‚¹)",
        data: <%- JSON.stringify(monthlyEarnings) %>,
        borderWidth: 3,
        borderColor: "rgb(34,197,94)",
        fill: false,
        tension: 0.2
      }]
    }
  });
</script>
